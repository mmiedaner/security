<!doctype html>
<html lang="en">
<title>Post Message Attack </title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="./js/jquery-2.1.4.min.js"></script>
<script src="./js/bootstrap.min.js"></script>
<script src="./js/pmat.js"></script>
<link rel="stylesheet" href="./css/pmat.css"/>
<link rel="stylesheet" href="./css/bootstrap.min.css"/>
</head>
<body>
<div id="container" class="container">
    <div id="headline" style="margin-bottom: 20px;">
        <span > <h1>Welcome to PostMessage Attack Tool (PMAT)</h1></span>
    </div>
    <div class="row" style="margin-bottom: 20px;">
        <div class="col-sm-8">
            <span><h2>Target</h2></span>
            <iframe id="victimFrame" src="" sandbox="allow-scripts allow-top-navigation allow-same-origin"
                    class="victim_frame">
            </iframe>
        </div>
        <div class="col-sm-4">
            <div id="targetHeadline">
                <h2>Configuration</h2>
            </div>
            <div id="content_row1" class="row">
                <div id="targetUrlLabel" class="col-sm-4">
                    <label for="targetURL"> Target URL</label>
                    <label for="message"> Message </label>
                    <label for="domain"> Domain </label>
                    <label for="attackURL">Attack URL</label>
                </div>
                <div id="targetUrlField" class=col-sm-8">
                    <input type="text" id="targetURL" value="https://www.rv24.de"/>
                    <input type="text" id="message" value='{"version":"1.0.0.","type":"showIframe"}'/>
                    <input type="text" id="domain" value="*"/>
                    <input type="text" id="attackURL" value="https://www.rv24.de"/>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-8">
            <span><h2>Log</h2></span>
            <div id="console" class="console"></div>
        </div>
        <div class="col-sm-4">
            <span><h2>Controls</h2></span>
            <input type="button" value="load frames" onclick="pmat.loadFrames()"/> &nbsp;&nbsp;&nbsp;&nbsp;
            <input type="button" value="send message" onclick="pmat.sendMessageToFrame()"/>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-12">
            <h2>Manual</h2>
            This tool helps you to demonstrate incorrect or missing validation of calls received via
            the window.postMessage() command.
            This page contains two iframes which can be separately loaded. Note the attack frame will not be visible,
            since it will not change anyway.
            Now load both frames, configure the message you want to send and fire up a debugger for the victim.
        </div>
        <div >
            <iframe id="attackFrame" src="" class="attack_frame"></iframe>
        </div>
    </div>
</body>
</html>
